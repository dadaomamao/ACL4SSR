###############################################################################
# 完整自包含 Clash.Meta YAML 配置
# - 规则集（rule-providers）完全按旧 INI 列表写入（含注释掉的规则）
# - 新增 🌐 全局智能 + 🇭🇰/🇯🇵/🇺🇸 区域智能组
# - 其他策略组与规则同旧版含义，确保即拷即用
###############################################################################

########################################
# 基础设置
########################################
mixed-port: 7890
allow-lan: true
bind-address: "0.0.0.0"
mode: rule
log-level: info
external-controller: 0.0.0.0:9090
secret: "请改成自己的管理密钥"

########################################
# DNS
########################################
dns:
  enable: true
  listen: 0.0.0.0:1053
  ipv6: false
  enhanced-mode: fake-ip
  default-nameserver: [223.5.5.5, 119.29.29.29, 8.8.8.8]
  fake-ip-filter: ["*.lan","*.localdomain","*.example"]

########################################
# 节点与订阅（占位，OpenClash 会自动填充）
########################################
proxies: []
proxy-providers: {}

########################################
# 规则集提供器（按旧文件顺序）
########################################
rule-providers:
  🇯🇵_日本家宽:                 # ; 已注释，若需启用请去掉 '#' 并在 rules 中引用
    type: http
    behavior: domain
    url: https://raw.githubusercontent.com/dadaomamao/ACL4SSR/refs/heads/main/crypto.list
    path: ./ruleset/jp-home.list
    ;interval: 86400
    enabled: false              # ← 保持禁用

  🎯_全球直连_main:
    type: http
    behavior: domain
    url: https://raw.githubusercontent.com/dadaomamao/ACL4SSR/refs/heads/main/Direct.list
    path: ./ruleset/direct-main.list
    ;interval: 86400

  🚀_节点选择_proxy-lite:
    type: http
    behavior: domain
    url: https://raw.githubusercontent.com/dadaomamao/ACL4SSR/refs/heads/main/ProxyLite.list
    path: ./ruleset/proxy-lite.list
    ;interval: 86400

  🤖_AI:
    type: http
    behavior: domain
    url: https://raw.githubusercontent.com/dadaomamao/ACL4SSR/refs/heads/main/AI.list
    path: ./ruleset/ai.list
    ;interval: 86400

  🎯_LAN:
    type: http
    behavior: domain
    url: https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/LocalAreaNetwork.list
    path: ./ruleset/lan.list
    ;interval: 86400

  🎯_UnBan:
    type: http
    behavior: domain
    url: https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/UnBan.list
    path: ./ruleset/unban.list
    ;interval: 86400

  # 🛑 广告拦截（已注释）
  # 🛑_BanAD:
  #   type: http
  #   behavior: domain
  #   url: https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/BanAD.list
  #   path: ./ruleset/banad.list
  #   interval: 86400

  📢_FCM:
    type: http
    behavior: domain
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/GoogleFCM/GoogleFCM.list
    path: ./ruleset/fcm.list
    ;interval: 86400

  🎯_GoogleCN:
    type: http
    behavior: domain
    url: https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/GoogleCN.list
    path: ./ruleset/google-cn.list
    ;interval: 86400

  🎯_SteamCN:
    type: http
    behavior: domain
    url: https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/Ruleset/SteamCN.list
    path: ./ruleset/steam-cn.list
    ;interval: 86400

  👨🏿‍💻_GitHub:
    type: http
    behavior: domain
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/GitHub/GitHub.list
    path: ./ruleset/github.list
    ;interval: 86400

  👨🏿‍💻_GitHub_classic:       # clash-classic 格式，仍按 domain 处理
    type: http
    behavior: domain
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/GitHub/GitHub.yaml
    path: ./ruleset/github-classic.list
    ;interval: 86400

  🍀_Google:
    type: http
    behavior: domain
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Google/Google.list
    path: ./ruleset/google.list
    ;interval: 86400

  💧_Copilot:
    type: http
    behavior: domain
    url: https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/Bing.list
    path: ./ruleset/bing.list
    interval: 86400

  🐬_OneDrive:
    type: http
    behavior: domain
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/OneDrive/OneDrive.list
    path: ./ruleset/onedrive.list
    ;interval: 86400

  🪟_Microsoft:
    type: http
    behavior: domain
    url: https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/Microsoft.list
    path: ./ruleset/microsoft.list
    interval: 86400

  🍎_Apple:
    type: http
    behavior: domain
    url: https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/Apple.list
    path: ./ruleset/apple.list
    ;interval: 86400

  📲_Telegram:
    type: http
    behavior: domain
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Telegram/Telegram.list
    path: ./ruleset/telegram.list
    ;interval: 86400

  ♻️_Speedtest:
    type: http
    behavior: domain
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Speedtest/Speedtest.list
    path: ./ruleset/speedtest.list
    ;interval: 86400

  📹_YouTube:
    type: http
    behavior: domain
    url: https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/Ruleset/YouTube.list
    path: ./ruleset/youtube.list
    ;interval: 86400

  🎮_Epic:
    type: http
    behavior: domain
    url: https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/Ruleset/Epic.list
    path: ./ruleset/epic.list
    ;interval: 86400

  🎮_Origin:
    type: http
    behavior: domain
    url: https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/Ruleset/Origin.list
    path: ./ruleset/origin.list
    ;interval: 86400

  🎮_Sony:
    type: http
    behavior: domain
    url: https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/Ruleset/Sony.list
    path: ./ruleset/sony.list
    interval: 86400

  🎮_Steam:
    type: http
    behavior: domain
    url: https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/Ruleset/Steam.list
    path: ./ruleset/steam.list
    ;interval: 86400

  🎮_Nintendo:
    type: http
    behavior: domain
    url: https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/Ruleset/Nintendo.list
    path: ./ruleset/nintendo.list
    ;interval: 86400

  🎞️_ChinaMedia:
    type: http
    behavior: domain
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/ChinaMedia/ChinaMedia.list
    path: ./ruleset/china-media.list
    ;interval: 86400

  🌍_ProxyMedia:
    type: http
    behavior: domain
    url: https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/ProxyMedia.list
    path: ./ruleset/proxy-media.list
    ;interval: 86400

  🚀_ProxyGFW:
    type: http
    behavior: domain
    url: https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/ProxyGFWlist.list
    path: ./ruleset/proxy-gfw.list
    ;interval: 86400

  🎯_ChinaDomain:
    type: http
    behavior: domain
    url: https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/ChinaDomain.list
    path: ./ruleset/china-domain.list
    ;interval: 86400

  🎯_ChinaCompanyIp:
    type: http
    behavior: ipcidr
    url: https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/ChinaCompanyIp.list
    path: ./ruleset/china-company-ip.list
    ;interval: 86400

  🎯_Download:
    type: http
    behavior: domain
    url: https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/Download.list
    path: ./ruleset/download.list
    ;interval: 86400

  🎯_ChinaList:
    type: http
    behavior: domain
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/China/China.list
    path: ./ruleset/china.list
    ;interval: 86400

########################################
# 代理组（含 LightGBM 智能组）
########################################
proxy-groups:
  - name: "🌐 全局智能"
    type: smart
    uselightgbm: true
    collectdata: true
    interval: 300
    include-all: true
    filter: ".*"

  - name: "🇭🇰 香港智能"
    type: smart
    uselightgbm: true
    collectdata: true
    interval: 300
    include-all: true
    filter: "(?=.*(港|HK|(?i)Hong))^((?!(台|日|韩|新|深|美)).)*$"

  - name: "🇯🇵 日本智能"
    type: smart
    uselightgbm: true
    collectdata: true
    interval: 300
    include-all: true
    filter: "(?=.*(日|JP|(?i)Japan))^((?!(港|台|韩|新|美)).)*$"

  - name: "🇺🇸 美国智能"
    type: smart
    uselightgbm: true
    collectdata: true
    interval: 300
    include-all: true
    filter: "(?=.*(美|US|(?i)States|America))^((?!(港|台|日|韩|新)).)*$"

  - {name: "🐸 手动切换", type: select, proxies: ["DIRECT","*"]}

  - name: "🚀 节点选择"
    type: select
    proxies:
      - "🌐 全局智能"
      - "🇭🇰 香港智能"
      - "🇯🇵 日本智能"
      - "🇺🇸 美国智能"
      - "🐸 手动切换"
      - "DIRECT"

  # 功能分组（示例）
  - {name: "📹 YouTube", type: select, proxies: ["🌐 全局智能","🚀 节点选择","DIRECT"]}
  - {name: "🤖 AI",      type: select, proxies: ["🌐 全局智能","🚀 节点选择","DIRECT"]}
  - {name: "📢 FCM",     type: select, proxies: ["🌐 全局智能","🚀 节点选择","DIRECT"]}
  - {name: "📲 Telegram",type: select, proxies: ["🌐 全局智能","🚀 节点选择","DIRECT"]}
  - {name: "🍀 Google",  type: select, proxies: ["🌐 全局智能","🚀 节点选择","DIRECT"]}
  - {name: "👨🏿‍💻 GitHub",type: select, proxies: ["🌐 全局智能","🚀 节点选择","DIRECT"]}
  - {name: "🪟 Microsoft",type: select, proxies: ["🌐 全局智能","🚀 节点选择","DIRECT"]}
  - {name: "🐟 漏网之鱼", type: select, proxies: ["DIRECT","🌐 全局智能"]}

########################################
# 分流规则
########################################
rules:
  # 直连
  - RULE-SET,🎯_全球直连_main,🎯 全球直连
  - RULE-SET,🎯_LAN,🎯 全球直连
  - RULE-SET,🎯_UnBan,🎯 全球直连
  - RULE-SET,🎯_GoogleCN,🎯 全球直连
  - RULE-SET,🎯_SteamCN,🎯 全球直连
  - GEOIP,CN,🎯 全球直连
  - GEOSITE,CN,🎯 全球直连

  # 代理
  - RULE-SET,🚀_节点选择_proxy-lite,🚀 节点选择
  - RULE-SET,🤖_AI,🤖 AI
  - RULE-SET,📢_FCM,📢 FCM
  - RULE-SET,👨🏿‍💻_GitHub,👨🏿‍💻 GitHub
  - RULE-SET,🍀_Google,🍀 Google
  - RULE-SET,💧_Copilot,🤖 AI
  - RULE-SET,🐬_OneDrive,🪟 Microsoft
  - RULE-SET,🪟_Microsoft,🪟 Microsoft
  - RULE-SET,🍎_Apple,🍎 Apple
  - RULE-SET,📲_Telegram,📲 Telegram
  - RULE-SET,♻️_Speedtest,♻️ Speedtest
  - RULE-SET,📹_YouTube,📹 YouTube
  - RULE-SET,🎮_Epic,🎮 游戏平台
  - RULE-SET,🎮_Origin,🎮 游戏平台
  - RULE-SET,🎮_Sony,🎮 游戏平台
  - RULE-SET,🎮_Steam,🎮 游戏平台
  - RULE-SET,🎮_Nintendo,🎮 游戏平台
  - RULE-SET,🎞️_ChinaMedia,🎞️ 国内媒体
  - RULE-SET,🌍_ProxyMedia,🌍 国外媒体
  - RULE-SET,🚀_ProxyGFW,🚀 节点选择

  # 其他直连
  - RULE-SET,🎯_Download,🎯 全球直连
  - RULE-SET,🎯_ChinaDomain,🎯 全球直连
  - RULE-SET,🎯_ChinaCompanyIp,🎯 全球直连
  - RULE-SET,🎯_ChinaList,🎯 全球直连
  - AND,((NETWORK,UDP),(DST-PORT,443)),DIRECT

  # 漏网
  - MATCH,🐟 漏网之鱼
